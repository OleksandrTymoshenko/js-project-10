{"version":3,"sources":["js/ApiService.js","js/RenderService.js","js/LocalStorageService.js","index.js"],"names":["ApiService","constructor","searchQuery","page","query","newQuery","getPopularFilms","fetch","_apiKey","then","response","json","data","results","catch","error","console","getFilmsByName","getFilmDetails","id","list","document","querySelector","modal","library","RenderService","obj","renderAllFilms","filmArray","markup","map","title","poster_path","toUpperCase","join","insertAdjacentHTML","renderFilmDetails","film","innerHTML","popularity","genres","overview","imagePath","upperTitle","LocalStorageService","filmsArray","addToLibrary","push","stringified","JSON","stringify","localStorage","setItem","getAllFilms","getItem","parsedData","parse","apiService","renderService","localStorageService","refs","input","naviListMain","naviListLib","headerMain","headerLib","onNaviListClick","e","target","textContent","style","display","addEventListener","getPopular","closeModal","classList","add","openModal","remove","dataset","action","filmElem","innerText","path","getAttribute","getDetails","nodeName","parentNode","window"],"mappings":"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","file":"src.2ed85773.js","sourceRoot":"../src","sourcesContent":["export default class ApiService {\n\n    _apiKey = '4a69d9470951ad07e8f0cc655bb46705'\n\n    constructor() {\n        this.searchQuery = '',\n        this.page = 1\n    }\n\n    set query(newQuery) {\n        this.query = newQuery\n    }\n\n    get query() {\n        return this.searchQuery\n    }\n\n    async getPopularFilms() {\n        return await fetch(`https://api.themoviedb.org/3/trending/movie/week?api_key=${this._apiKey}`)\n            .then(response => response.json())\n            .then(data => data.results)\n            .catch(error => console.error(error))\n    }\n\n    async getFilmsByName() {\n        return await fetch(`https://api.themoviedb.org/3/search/movie?query=${this.searchQuery}&api_key=${this._apiKey}`)\n            .then(response => response.json())\n            .then(data => data.results)\n            .catch(error => console.error(error))\n    }\n\n    async getFilmDetails(id) {\n        return await fetch(`https://api.themoviedb.org/3/movie/${id}?api_key=${this._apiKey}`)\n            .then(response => response.json())\n            .catch(error => console.error(error))\n    }\n\n}","const list = document.querySelector('.list')\nconst modal = document.querySelector('[data-modal]')\nconst library = document.querySelector('[data-lib]')\n\nexport default class RenderService {\n    constructor() {\n        this.obj = {}\n    }\n\n    renderAllFilms(filmArray) {\n        const markup = filmArray.map(({id, title, poster_path}) => {\n\n            const imagePath = `https://image.tmdb.org/t/p/w500/${poster_path}`\n            const upperTitle = title.toUpperCase()\n\n            return `\n                    <li class=\"list__item\" id=${id}>      \n                        <img class=\"item__img\" src=${imagePath} alt=\"poster\"> \n                        \n                        <p class=\"item__title\">${upperTitle}</p>\n                        <p class=\"item__genre\">Drama, Action | 2020</p>\n                    </li>\n                `\n        }).join('')\n\n        list.insertAdjacentHTML('afterbegin', markup)\n    }\n\n    renderFilmDetails(film) {\n        modal.innerHTML = ''\n\n        const {id, poster_path, title, popularity, genres, overview} = film\n        const imagePath = `https://image.tmdb.org/t/p/w400/${poster_path}`\n        const upperTitle = title.toUpperCase()\n        \n        const markup = `\n            <div class=\"film-details\" id=${id}>\n\n                <div class=\"img-thumb\" id=${id}>\n                    <img class=\"film-details__path\" src=${imagePath} alt=\"poster\" width=\"396\">\n                </div>\n\n                <div class=\"about\">\n                    <p class=\"about__title\">${upperTitle}</p>\n\n                    <div class=\"details\">\n                        <div class=\"details__names-col\">\n                            <p class=\"details__value\">Vote / Votes<p>\n                            <p class=\"details__value\">Popularity<p>\n                            <p class=\"details__value\">Original Title<p>\n                            <p class=\"details__value\">Genre<p>\n                        </div>\n                        \n                        <div class=\"values-col\">\n                            <p class=\"details__name\">7.3 / 1260<p>\n                            <p class=\"details__name popularity\">${popularity}<p>\n                            <p class=\"details__name\">${upperTitle}<p>\n                            <p class=\"details__name\">Western<p>\n                        </div>\n                    </div>\n\n                    <div class=\"about__description\">\n                        <p class=\"about__description--title\" >ABOUT</p>\n\n                        <p class=\"about__description--text\">${overview}</p>\n                    </div>\n\n                    <div class=\"btn-block\">\n                        <button class=\"about__btn lib\" data-action=\"addToLib\">add to watched</button>\n                        <button class=\"about__btn queue\" data-action=\"addToQue\">add to queue</button>\n                    </div>\n\n                </div>\n\n                <button class=\"close-btn\" data-action=\"close\">x</button>\n            </div>\n        `\n\n        modal.insertAdjacentHTML('afterbegin', markup)\n    }\n\n}","export default class LocalStorageService {\n    constructor() {\n      this.filmsArray = []\n    }\n\n    addToLibrary(obj) {\n        // const data = localStorage.getItem('myFilms')\n        // const filmArray = JSON.parse(data)\n\n        // if (filmArray) {\n        //     filmArray.forEach(film => {\n        //         console.log(film.id)\n        //     })\n        // }\n\n        this.filmsArray.push(obj)\n        const stringified = JSON.stringify(this.filmsArray)\n        localStorage.setItem('myArr', stringified)\n    }\n\n    getAllFilms() {\n        const data = localStorage.getItem('myArr')\n        const parsedData = JSON.parse(data)\n        return parsedData\n    }\n\n    \n\n\n}","import './sass/main.scss';\nimport ApiService from './js/ApiService';\nimport RenderService from './js/RenderService';\nimport LocalStorageService from './js/LocalStorageService';\n\nconst apiService = new ApiService()\nconst renderService = new RenderService()\nconst localStorageService = new LocalStorageService()\n\nconst refs = {\n    input: document.querySelector('.search-block__input'),\n    list: document.querySelector('.list'),\n    modal: document.querySelector('[data-modal]'),\n    naviListMain: document.querySelector('.navi__list[data-action=\"main\"]'),\n    naviListLib: document.querySelector('.navi__list[data-action=\"library\"]'),\n    headerMain: document.querySelector('header[data-action=\"main\"]'),\n    headerLib: document.querySelector('header[data-action=\"library\"]'),\n    \n}\n\nrefs.headerLib.style.display = \"none\";\n\n\nfunction onNaviListClick(e) {\n    if(e.target.textContent === 'Home'){\n        refs.headerMain.style.display = \"block\";\n        refs.headerLib.style.display = \"none\";\n    }\n    if(e.target.textContent === 'My library'){\n        refs.headerMain.style.display = \"none\";\n        refs.headerLib.style.display = \"block\";\n    }\n}\n\nrefs.naviListMain.addEventListener('click', onNaviListClick) \nrefs.naviListLib.addEventListener('click', onNaviListClick) \n\n\n\nconst getPopular = () => {\n    apiService.getPopularFilms().then(renderService.renderAllFilms)\n}\n\nconst closeModal = () => {\n    refs.modal.classList.add('hidden')\n}\n\nconst openModal = (id) => {\n    \n    refs.modal.classList.remove('hidden')\n    apiService.getFilmDetails(id).then(renderService.renderFilmDetails)\n\n    refs.modal.addEventListener('click', e => {\n        if (e.target.dataset.action === 'close') {\n            closeModal()\n        }\n\n        if (e.target.dataset.action === 'addToLib') {\n           const filmElem = document.querySelector('.film-details')\n           \n            const obj = {\n                id: filmElem.id,\n                title: filmElem.querySelector('.about__title').innerText,\n                overview: filmElem.querySelector('.about__description--text').innerText,\n                path: filmElem.querySelector('.film-details__path').getAttribute('src'),\n                popularity: filmElem.querySelector('.popularity').innerText,\n            }\n           \n\n           localStorageService.addToLibrary(obj)\n        }\n   })\n}  \n\n\nconst getDetails = (e) => {\n\n    if (e.target.nodeName === 'IMG') {\n            const { id } = e.target.parentNode\n            openModal(id)\n        }\n}\n\nwindow.addEventListener('load', getPopular)\nrefs.list.addEventListener('click', getDetails)"]}